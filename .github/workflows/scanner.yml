name: Scanner Crypto ETH/BTC Focus

on:
  schedule:
    # Executa a cada 15 minutos durante horário de trading
    - cron: '*/15 6-23 * * *'
  workflow_dispatch: # Permite execução manual

jobs:
  crypto-scanner:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: 🏁 Checkout Repository
      uses: actions/checkout@v4
      
    - name: 🐍 Setup Python 3.11
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: 📦 Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install numpy==1.24.3
        pip install pandas==2.0.3
        pip install scikit-learn==1.3.0
        pip install requests==2.31.0
        pip install python-telegram-bot==20.3
        pip install ta==0.10.2
        pip install ccxt==4.4.97
        pip install pandas-ta==0.3.14b
        
    - name: 🚀 Run ETH/BTC Scanner
      timeout-minutes: 8
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        TZ: 'UTC'
      run: |
        echo "🎯 Iniciando Scanner ETH/BTC Focus..."
        echo "📊 Analisando BTC/USDT e ETH/USDT com 6 setups..."
        echo "⏰ Executado em: $(date)"
        python scanner_github_actions.py
        
    - name: 📋 Debug Info on Failure
      if: failure()
      run: |
        echo "📊 Informações de debug:"
        echo "Python: $(python --version)"
        echo "Bibliotecas instaladas:"
        pip list | grep -E "(pandas|numpy|ccxt|ta|requests)"
        echo "Variáveis de ambiente configuradas: $(env | grep TELEGRAM | wc -l)"
